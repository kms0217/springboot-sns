<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Mygram</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
          integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/home.css}">
    <link rel="stylesheet" th:href="@{/css/nav.css}">
</head>
<body>
<div th:replace="/nav.html :: fragment-nav"></div>
<div class="content">
    <div class="content-container h-100 row" style="margin-left: 0!important; margin-right: 0!important;">
        <div class="post-list h-100 col-8">
            <div th:each="p : ${homeDto.postList}">
                <div th:replace="/postTemplate.html :: fragment-post(post = p)"></div>
            </div>
        </div>
        <div class="side col-4">
            <div class="recommend-wrapper" style="position: fixed; width: fit-content">
                <text class="recommend-header col-8" style="font-size: 18px; font-weight: 600; color: #bdbdbd">회원님을 위한
                    추천
                </text>
                <a th:href="@{/allRecommend}"
                   style="padding-left: 80px; text-decoration: none; font-weight: 600; color: black">모두 보기</a>
                <div class="recommend-list" style="padding-top: 15px;" th:each="u : ${homeDto.userList}">
                    <div class="recommend-content row" style="width: inherit">
                        <div class="col-1 recommend-img">
                            <img th:src="@{/image/default-profile.png}" style="border-radius: 50%;width: 32px;">
                        </div>
                        <div class="col-7">
                            <p style="padding-left: 15px; padding-top: 3px; font-weight: 400">[[${u.username}]]</p>
                        </div>
                        <div class="col-4">
                            <button style="background-color: white; border: 0;" th:attr="onclick=|follow('${u.userId}')|">
                                <p style="font-size: 15px; padding-left: 20px; padding-top: 3px; font-weight: 600; color: #00aeff">
                                    팔로우</p>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    function follow(userId) {
        $.ajax({
            type: "post",
            url: '/api/follow/' + userId,
            success: function () {
                alert("success");
            },
            error: function () {
                alert("fail")
            }
        });
    }
</script>
</body>
</html>